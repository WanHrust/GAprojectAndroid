var crypto = require('crypto'); 
var rand = require('csprng'); 
var mongoose = require('mongoose'); 
var gravatar = require('gravatar'); 
var Event = require('config/modelEvent');  


exports.action = function(act,userEmail, callback) {  

    //Finding the last Event
    Event.findOne({}, {}, { sort: { 'date_action' : -1 } }, function(err, event) {
        //Add the action of the user to the ones of the actions
        event.usersActing .push({ email : userEmail, amountEnergy : act });

        event.save(function (err) {
            if (err) return handleError(err)
            console.log('Unexpected success!');
        });
        
    });
    
    console.log(act);
    callback({'response':act, 'res':"true"});   
}  
